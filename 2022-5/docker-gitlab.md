## 腾讯云/阿里云通过docker安装git服务

这一次是需要一个文件管理系统把之前写的几个小说和对应的资料放到腾讯云的轻量级服务器同步.想到了使用git作为服务器,之后就是确定使用万能的docker了.

### Gogs
这一次使用的docker包用的是Gogs,核心是一款极易搭建的自助 Git 服务.用的是golang开发的一款软件.

### 安装
感谢万能的docker,使用root账号安装.
>sudo docker pull gogs/gogs

由于我们之后要把容器部署到特定的文件夹下面,避免由于使用docker默认的目录导致不好查找(之前安装django的深刻教训)

>mkdir  /home/gogs

未来的docker目录

>创建并运行一个容器，
sudo docker run -d -p 10022:22 -p 13000:3000 -v /home/gogs:/data gogs/gogs

-p 10022:22 将宿主机的10022端口映射到容器的22端口.这里是docker的ssh服务映射到10022端口

-p 13000:3000 将宿主机的13000端口映射到容器的3000端口，10022端口和13000端口可以根据自己的情况修改.这里是吧gogs的服务对应的端口3000映射到13000端口中.

-v /home/gogs:/data gogs/gogs 目录映射,把我们容器目录挂载到我们刚刚建好的/home/gogs目录下

![错误](/2022-5/docker/docker-2.jpg)

这里出现了错误,一开始我看错误提示还以为因为开放了端口后,没有去防火墙iptable注册,但是翻了防火墙,发现并没有问题,查了一下网络,发现可能需要docker重启.
>systemctl restart docker
docker start .....
![重启](/2022-5/docker/docker2.jpg)


### 腾讯云阿里云防火墙开放
注意我这里使用了云服务器默认的端口只是固定开放了22 23 80 443等常用的服务端口,我们上面映射了10022和10030端口.所以打开防火墙,设置规则.


### 简单配置
ok,我们现在可以访问初始化的地址了.通常是服务器地址:10030 ,这里我们假设服务器的ip是192.168.109.128


访问http://192.168.0.1:13000
出现了设置页面,包含两个部分,一个是设置数据库,一个是设置基本路径.我们这里建议数据库采用轻量版本的sqlite,这样就不需要额外部署mysql.
![](/2022-5/docker/docker3.jpg)

第二个页面是这样的
![](/2022-5/docker/docker5.jpg)
这里面注意,域名是我们自己服务器的ip,ssh端口通常是22,http端口是3000,这两个端口都是我们刚才映射过的端口.
然后应用url就是我们刚刚提到过的也就是我们现在正在访问的地址.
都完成后点击确定.

之后就会自动跳转了到这个页面也就代表大功告成了
![](/2022-5/docker/docker6.jpg)
现在只需要按照git的用法进行注册登录即可开始使用了

当然如果出现这个页面也基本不用担心
![](/2022-5/docker/docker4.jpg)
只是单纯的配置url出现了问题,把地址端口更改为配置的端口即可